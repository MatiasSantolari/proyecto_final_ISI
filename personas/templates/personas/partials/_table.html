{% load persona_tags %}
<div class="table-responsive" style="overflow-x: auto;">
  <table
    id="{{ datatable.definition.table_id }}"
    class="table table-sm table-hover table-bordered align-middle mb-0"
    style="min-width: 1300px; font-size: 0.95rem;"
    data-datatable="true"
    data-datatable-options='{{ datatable.options_json }}'
  >
    <thead class="table-light text-center">
      <tr>
        <th>Apellido</th>
        <th>Nombre</th>
        <th>DNI</th>
        <th>Email</th>
        <th>Tel√©fono</th>
        <th>Tipo Usuario</th>
        <th>Estado</th>
        <th>Cargo</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for persona in personas %}
        <tr
          class="fila-persona"
          data-tipo="{{ persona.tipo_usuario }}"
          data-dni="{{ persona.dni }}"
        >
          <td>{{ persona.apellido }}</td>
          <td>{{ persona.nombre }}</td>
          <td>{{ persona.dni }}</td>
          <td>{{ persona.email }}</td>
          <td>{{ persona.telefono_completo }}</td>
          <td>
            <span class="badge {{ persona.tipo_usuario|tipo_badge_class }}">
              {{ persona.tipo_usuario|tipo_badge_label }}
            </span>
          </td>
          <td>
            <span class="badge {{ persona.estado|estado_badge_class }}">
              {{ persona.estado|estado_badge_label }}
            </span>
          </td>
          <td>{{ persona.cargo }}</td>
          <td class="text-center">
            <button
              class="btn btn-sm btn-editar btn-outline-secondary"
              data-bs-toggle="modal"
              data-bs-target="#modalPersona"
              data-id="{{ persona.id }}"
              data-nombre="{{ persona.nombre }}"
              data-apellido="{{ persona.apellido }}"
              data-dni="{{ persona.dni }}"
              data-email="{{ persona.email }}"
              data-prefijo="{{ persona.prefijo_pais }}"
              data-telefono="{{ persona.telefono }}"
              data-fecha-nacimiento="{{ persona.fecha_nacimiento|date:'Y-m-d' }}"
              data-genero="{{ persona.genero }}"
              data-pais="{{ persona.pais }}"
              data-provincia="{{ persona.provincia }}"
              data-ciudad="{{ persona.ciudad }}"
              data-calle="{{ persona.calle }}"
              data-numero="{{ persona.numero }}"
              data-tipo-usuario="{{ persona.tipo_usuario }}"
              {% if persona.tipo_persona != 'normal' %}
                data-estado="{{ persona.estado }}"
              {% else %}
                data-estado=""
              {% endif %}
              {% if persona.cargo %}
                data-departamento="{{ persona.departamento_id }}"
                data-cargo="{{ persona.cargo }}"
              {% else %}
                data-departamento=""
                data-cargo=""
              {% endif %}
              onclick="editarPersona(this)"
              title="Editar"
            >
              <i class="bi bi-pencil-square"></i>
            </button>

            <button
              class="btn btn-sm btn-outline-info"
              data-bs-toggle="modal"
              data-bs-target="#modalVerPersona{{ persona.id }}"
              data-id="{{ persona.id }}"
              title="Ver"
            >
              <i class="bi bi-eye"></i>
            </button>

            <button
              class="btn btn-sm btn-outline-danger btn-eliminar"
              data-id="{{ persona.id }}"
              data-nombre="{{ persona.apellido }}, {{ persona.nombre }}"
              title="Eliminar"
            >
              <i class="bi bi-trash3"></i>
            </button>
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
